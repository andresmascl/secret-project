services:
  scrapbot:
    build: .
    container_name: scrapbot-ai
    network_mode: host
    privileged: true 
    
    env_file:
      - .env

    devices:
      - "/dev/snd:/dev/snd"
    
    volumes:
      # Use the XDG_RUNTIME_DIR variable for the host's pulse socket
      - ${XDG_RUNTIME_DIR}/pulse/native:${XDG_RUNTIME_DIR}/pulse/native
      - /var/lib/dbus:/var/lib/dbus
      - .:/app
      
    environment:
      # Tell the container where to find the PulseAudio server
      - PULSE_SERVER=unix:${XDG_RUNTIME_DIR}/pulse/native
      - PYTHONUNBUFFERED=1 
    
    group_add:
      - audio
    restart: unless-stopped